plot(g4)
g1<-ggplot(Forward, aes(x = APA, y = Sla, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "Step Latency (s)") +
scale_x_continuous(name = "Forward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, col="red", data=df)
plot(g4)
ints<-c((0.3613-0.5*0.076425),(0.3613+0.5*0.076425))
slopes<-c((0.004113-0.5*0.0001969),(0.004113+0.5*0.0001969))
df<-data.frame(ints,slopes)
g1<-ggplot(Forward, aes(x = APA, y = Sla, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "Step Latency (s)") +
scale_x_continuous(name = "Forward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, col="black", data=df)
plot(g4)
ints<-c((0.303613-0.5*0.076425),(0.303613+0.5*0.076425))
slopes<-c((0.004113-0.5*0.0001969),(0.004113+0.5*0.0001969))
df<-data.frame(ints,slopes)
g1<-ggplot(Forward, aes(x = APA, y = Sla, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "Step Latency (s)") +
scale_x_continuous(name = "Forward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, col="black", data=df)
plot(g4)
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,2), col="black", data=df)
plot(g4)
g4<-g3+geom_abline(intercept=ints, slope=slopes, lwd=2, lty=c(1,2), col="black", data=df)
plot(g4)
g4<-g3+geom_abline(intercept=ints, slope=slopes, lwd=2, col="black", data=df)
plot(g4)
FOG_lab<-c("FOG-","FOG+")
ints<-c((0.303613-0.5*0.076425),(0.303613+0.5*0.076425))
slopes<-c((0.004113-0.5*0.0001969),(0.004113+0.5*0.0001969))
df<-data.frame(FOG_lab,ints,slopes)
g1<-ggplot(Forward, aes(x = APA, y = Sla, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "Step Latency (s)") +
scale_x_continuous(name = "Forward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, col="black", data=df)
plot(g4)
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,2) col="black", data=df)
plot(g4)
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,2), col="black", data=df)
plot(g4)
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,3), col="black", data=df)
plot(g4)
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,4), col="black", data=df)
plot(g4)
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
plot(g4)
modelAP_SLe3 <- lmer(StepLength ~ APA*FOG.c + (1+APA|subject), data = Forward, REML=FALSE)
summary(modelAP_SLe3)
FOG_lab<-c("FOG-","FOG+")
ints<-c((0.2133427-0.5*-0.0102636),(0.2133427+0.5*-0.0102636))
slopes<-c((0.0017533-0.5*-0.0018965),(0.0017533+0.5*-0.0018965))
df<-data.frame(FOG_lab,ints,slopes)
g1<-ggplot(Forward, aes(x = APA, y = StepLength, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "Step Length") +
scale_x_continuous(name = "Forward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
plot(g4)
g2<-g1+scale_y_continuous(name = "Step Length (m)") +
scale_x_continuous(name = "Forward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
plot(g4)
modelStpWdth3 <- lmer(stepWidth ~ APA*FOG.c + (1+APA|subject), data = Forward, REML=FALSE)
summary(modelStpWdth3)
Forward$FOG_lab <- factor(Forward$FOGstatus,
levels = c(0,1),
labels = c("FOG-", "FOG+"))
FOG_lab<-c("FOG-","FOG+")
ints<-c((0.1572-0.5*-0.002087),(0.1572+0.5*-0.002087))
slopes<-c((-0.0006669-0.5*0.00007859),(-0.0006669-0.5*0.00007859))
df<-data.frame(FOG_lab,ints,slopes)
g1<-ggplot(Forward, aes(x = APA, y = stepWidth, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "Step Width (m)") +
scale_x_continuous(name = "Forward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
plot(g4)
modelAP_COMfo3 <- lmer(AP_COMatFO ~ APA*FOG.c + (1+APA|subject), data = Forward, REML=FALSE)
summary(modelAP_COMfo3)
FOG_lab<-c("FOG-","FOG+")
ints<-c((0.1290048-0.5*0.009588),(0.1290048+0.5*0.009588))
slopes<-c((0.0002164-0.5*-0.0002135),(0.0002164+0.5*-0.0002135))
df<-data.frame(FOG_lab,ints,slopes)
g1<-ggplot(Forward, aes(x = APA, y = AP_COMatFO, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "AP COM at Foot Off") +
scale_x_continuous(name = "Forward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
plot(g4)
Forward$FOG_lab <- factor(Backward$FOGstatus,
levels = c(0,1),
labels = c("FOG-", "FOG+"))
modelSla3 <- lmer(Sla ~ APA*FOG.c + (1+APA|subject), data = Backward, REML=FALSE)
summary(modelSla3)
modelAP_MOS3 <- lmer(AP_MOS ~ APA*FOG.c + (1+APA|subject), data = Backward, REML=FALSE)
summary(modelAP_MOS3)
modelML_MOS3 <- lmer(ML_MOS ~ APA*FOG.c + (1+APA|subject), data = Backward, REML=FALSE)
summary(modelML_MOS3)
modelAP_SLe3 <- lmer(StepLength ~ APA*FOG.c + (1+APA|subject), data = Backward, REML=FALSE)
summary(modelAP_SLe3)
modelStpWdth3 <- lmer(stepWidth ~ APA*FOG.c + (1+APA|subject), data = Backward, REML=FALSE)
summary(modelStpWdth3)
modelAP_COMfo3 <- lmer(AP_COMatFO ~ APA*FOG.c + (1+APA|subject), data = Backward, REML=FALSE)
summary(modelAP_COMfo3)
modelML_COMfo3 <- lmer(ML_COMatFO ~ APA*FOG.c + (1+APA|subject), data = Backward, REML=FALSE)
summary(modelML_COMfo3)
modelComDisp3 <- lmer(COMdisp ~ APA*FOG.c + (1+APA|subject), data = Backward, REML=FALSE)
summary(modelComDisp3)
summary(modelSla3)
FOG_lab<-c("FOG-","FOG+")
ints<-c((0.2953811-0.5*0.0451307),(0.2953811+0.5*0.0451307))
slopes<-c((0.0026763-0.5*-0.0028757),(0.0026763+0.5*-0.0028757))
df<-data.frame(FOG_lab,ints,slopes)
g1<-ggplot(Backward, aes(x = APA, y = Sla, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "Step Latency (s)") +
scale_x_continuous(name = "Backward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
plot(g4)
Backward$FOG_lab <- factor(Backward$FOGstatus,
levels = c(0,1),
labels = c("FOG-", "FOG+"))
FOG_lab<-c("FOG-","FOG+")
ints<-c((0.2953811-0.5*0.0451307),(0.2953811+0.5*0.0451307))
slopes<-c((0.0026763-0.5*-0.0028757),(0.0026763+0.5*-0.0028757))
df<-data.frame(FOG_lab,ints,slopes)
g1<-ggplot(Backward, aes(x = APA, y = Sla, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "Step Latency (s)") +
scale_x_continuous(name = "Backward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
plot(g4)
modelML_MOS3 <- lmer(ML_MOS ~ APA*FOG.c + (1+APA|subject), data = Backward, REML=FALSE)
summary(modelML_MOS3)
FOG_lab<-c("FOG-","FOG+")
ints<-c((0.0169298-0.5*0.0175742),(0.0169298+0.5*0.0175742))
slopes<-c((0.0002740-0.5*-0.0028757),(0.0002740+0.5*-0.0028757))
df<-data.frame(FOG_lab,ints,slopes)
g1<-ggplot(Backward, aes(x = APA, y = ML_MOS, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "ML MOS") +
scale_x_continuous(name = "Backward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
plot(g4)
FOG_lab<-c("FOG-","FOG+")
ints<-c((0.0169298-0.5*0.0175742),(0.0169298+0.5*0.0175742))
slopes<-c((0.0002740-0.5*-0.0002967),(0.0002740+0.5*-0.002967))
df<-data.frame(FOG_lab,ints,slopes)
g1<-ggplot(Backward, aes(x = APA, y = ML_MOS, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "ML MOS") +
scale_x_continuous(name = "Backward APA")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
plot(g4)
ints<-c((0.0169298-0.5*0.0175742),(0.0169298+0.5*0.0175742))
slopes<-c((0.0002740-0.5*-0.0002967),(0.0002740+0.5*-0.0002967))
df<-data.frame(FOG_lab,ints,slopes)
g1<-ggplot(Backward, aes(x = APA, y = ML_MOS, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "ML MOS") +
scale_x_continuous(name = "Backward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
plot(g4)
modelStpWdth3 <- lmer(stepWidth ~ APA*FOG.c + (1+APA|subject), data = Backward, REML=FALSE)
summary(modelStpWdth3)
FOG_lab<-c("FOG-","FOG+")
ints<-c((0.09577-0.5*-0.01233),(0.09577+0.5*-0.01233))
slopes<-c((-0.0002517-0.5*0.00149),(-0.0002517+0.5*0.00149))
df<-data.frame(FOG_lab,ints,slopes)
g1<-ggplot(Backward, aes(x = APA, y = stepWidth, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "Step Width (m)") +
scale_x_continuous(name = "Backward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
plot(g4)
modelAP_COMfo3 <- lmer(AP_COMatFO ~ APA*FOG.c + (1+APA|subject), data = Backward, REML=FALSE)
summary(modelAP_COMfo3)
FOG_lab<-c("FOG-","FOG+")
ints<-c((0.1228661-0.5*0.0090931),(0.1228661+0.5*0.0090931))
slopes<-c((0.0002953-0.5*-0.0004178),(0.0002953+0.5*-0.0004178))
df<-data.frame(FOG_lab,ints,slopes)
g1<-ggplot(Backward, aes(x = APA, y = AP_COMatFO, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "AP COM at Foot Off") +
scale_x_continuous(name = "Backward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
plot(g4)
FOG_lab<-c("FOG-","FOG+")
ints<-c((0.09577-0.5*-0.01233),(0.09577+0.5*-0.01233))
slopes<-c((-0.0002517-0.5*0.00149),(-0.0002517+0.5*0.00149))
df<-data.frame(FOG_lab,ints,slopes)
g1<-ggplot(Backward, aes(x = APA, y = stepWidth, group = subject)) +
geom_point(aes(bg=subject), pch=21, size=2, col="black") +
stat_smooth(aes(col=subject), method=lm, se=FALSE, size=1) +
scale_color_grey()+scale_fill_grey()+
facet_wrap(~FOG_lab)
g2<-g1+scale_y_continuous(name = "Step Width (m)") +
scale_x_continuous(name = "Backward APA")
g3 <- g2 + theme_bw()+theme(axis.text=element_text(size=14, colour="black"),
axis.title=element_text(size=14,face="bold")) +
theme(legend.text=element_text(size=14), legend.title=element_text(size=14))+
theme(strip.text.x = element_text(size = 14))+
theme(legend.position = "none")
g4<-g3+geom_abline(aes(intercept=ints, slope=slopes), lwd=2, lty=c(1,5), col="black", data=df)
plot(g4)
citation("influence.ME")
?drm()
citation()
citation(lme4)
citation("lme4")
citation("drc")
citation("ggplot2")
citation("lmerTest")
x  <- seq(-2, 2, 0.05)
y1 <- pnorm(x)
y2 <- pnorm(x,1,1)
plot(x,y1,type="l",col="red")
plot(x,y2,type="l",col="green")
plot(x,y1,type="l",col="red")
lines(x,y2,col="green")
plot(x,y1,type="p",col="red")
points(x,y2,col="green")
# Loading the essential libraries.
library("ggplot2"); library("lme4"); library("car"); library("dplyr"); library("lmerTest");
require(ggplot2)
require(car)
require(corrplot)
ad <- read.csv("https://raw.githubusercontent.com/keithlohse/LMER_Clinical_Science/master/data/data_nonlinear_v4.csv")
head(ad
)
install.packages("dplyr")
install.packages("lmerTest")
# Loading the essential libraries.
library("ggplot2"); library("lme4"); library("car"); library("dplyr"); library("lmerTest");
library("ggplot2");
## ----------------------- Basic Data Visualization ----------------------------
## FIM scores by gender and time -----------------------------------------------
g1<-ggplot(DATA, aes(x = month, y = rasch_FIM)) +
geom_point(aes(fill=as.factor(subID)), pch=21, size=2, stroke=1.25) +
geom_line(aes(group=subID)) +
facet_wrap(~AIS_grade)
list.files()
# Import the .csv file into R.
# We will save this file in the R environment as an object called "DATA".
DATA<-read.csv("./data_session1.csv", header = TRUE, sep=",",
na.strings=c("NA","NaN"," ",""))
# Use the head() function to check the structure of the data file.
head(DATA)
## ----------------------- Basic Data Visualization ----------------------------
## FIM scores by gender and time -----------------------------------------------
g1<-ggplot(DATA, aes(x = month, y = rasch_FIM)) +
geom_point(aes(fill=as.factor(subID)), pch=21, size=2, stroke=1.25) +
geom_line(aes(group=subID)) +
facet_wrap(~AIS_grade)
# For this analysis, you will need to install and then open the following packages:
#install.packages("dplyr"); install.packages("ggplot2")
library("dplyr"); library("ggplot2"); library("lme4"); library("lmerTest");
library("car")
# On KRL Computer
setwd("C:/Users/u6015231/Documents/GitHub/difficulty_EEG/prac_study")
list.files()
SCORES<-read.csv("./data_SCORES.csv", header = TRUE)
head(SCORES)
## Selecting the Practice Data ----
PRAC<-subset(SCORES, phase != "resting")
PRAC<-subset(PRAC, phase != "posttest")
PRAC<-subset(PRAC, phase != "pretest")
PRAC$phase<-factor(PRAC$phase)
summary(PRAC$phase)
## Contrast Coding the Group Variable ----
PRAC$self.c<-(as.numeric(PRAC$group)-1.5)*(-1)
head(PRAC)
summary(PRAC$diff)
summary(PRAC$diff.c) # diff.c was mean centered on 5
summary(PRAC$scoreQ)
PRAC$scoreQ.c<-PRAC$scoreQ-mean(PRAC$scoreQ)
summary(PRAC$block)
PRAC$block.c<-PRAC$block-mean(PRAC$block)
summary(PRAC$block.c)
PRAC$eng_st.c<-PRAC$eng_st-mean(PRAC$eng_st)
summary(PRAC$eng_st.c)
PRAC$mot_st.c<-PRAC$mot_st-mean(PRAC$mot_st)
summary(PRAC$mot_st.c)
#Descriptive Statistics of Practice --------------------------------------------
head(PRAC)
summary(PRAC$group)
SELF<-subset(PRAC, group=="self")
YOKE<-subset(PRAC, group=="yoked")
## 2A Plot of Scores over Time ------------------------------------------------
g1<-ggplot(PRAC, aes(x = jitter(block), y = score)) +
geom_point(aes(group=subID), fill="grey", pch=21, size=2, alpha = .5) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(aes(lty=group), col="black", method="loess", lwd=1.5, se=FALSE)+
facet_wrap(~group, ncol=1)
g2<-g1+scale_x_continuous(name = "Block of Practice") +
scale_y_continuous(name = "In-Game Score")
g3 <- g2 + theme_bw() +
theme(axis.text=element_text(size=16, colour="black"),
axis.title=element_text(size=16,face="bold"),
plot.title=element_text(size=16,face="bold", hjust = 0.5)) +
theme(strip.text.x = element_text(size = 16))+
theme(legend.position="none")
plot(g3)
## 2B Plot of Difficulty over Time ------------------------------------------------
g1<-ggplot(SELF, aes(x = jitter(block), y = jitter(diff))) +
geom_point(aes(group=subID), fill="grey", pch=21, size=2, alpha = .5) +
geom_line(aes(group=subID), col="grey") +
stat_smooth(col="black", method="loess", lwd=1.5, se=FALSE)
g2<-g1+scale_x_continuous(name = "Block of Practice") +
scale_y_continuous(name = "Difficulty", breaks=c(1:9))
g3 <- g2 + theme_bw() +
theme(axis.text=element_text(size=16, colour="black"),
axis.title=element_text(size=16,face="bold"),
plot.title=element_text(size=16,face="bold", hjust = 0.5)) +
theme(strip.text.x = element_text(size = 16))+
theme(legend.position="none")
plot(g3)
# Descriptive statistics for the groups
head(PRAC)
BY_SUB<-summarize(group_by(PRAC, subID),
group = group[1],
meanScore = mean(score, na.rm=TRUE),
meanDiff = mean(diff, na.rm=TRUE),
meanEng = mean(eng_st, na.rm=TRUE),
meanMot = mean(mot_st, na.rm=TRUE))
aggregate(meanScore ~ group, BY_SUB, mean)
aggregate(meanScore ~ group, BY_SUB, sd)
t.test(meanScore~group, BY_SUB, paired=FALSE, var.equal=TRUE)
aggregate(meanDiff ~ group, BY_SUB, mean)
aggregate(meanDiff ~ group, BY_SUB, sd)
t.test(meanDiff~group, BY_SUB, paired=FALSE, var.equal=TRUE)
aggregate(meanEng ~ group, BY_SUB, mean)
aggregate(meanEng ~ group, BY_SUB, sd)
t.test(meanEng~group, BY_SUB, paired=FALSE, var.equal=TRUE)
aggregate(meanMot ~ group, BY_SUB, mean)
aggregate(meanMot ~ group, BY_SUB, sd)
t.test(meanMot~group, BY_SUB, paired=FALSE, var.equal=TRUE)
## Power Spectral Density for Fz -----------------------------------------------
EEG<-read.csv("./data_EEG_MASTER.csv", header = TRUE)
EEG2<-EEG %>%
group_by_(.dots=c("subID","Hz")) %>%
summarize(
Group=group[1],
Fz=mean(Fz, na.rm=TRUE))
head(EEG2)
EEG2<-subset(EEG2, Hz>=1)
EEG2<-subset(EEG2, Hz<=20)
head(EEG2)
EEG3<-EEG2 %>%
group_by_(.dots=c("Group","Hz")) %>%
summarize(
mFz=mean(Fz, na.rm=TRUE))
summary(EEG3$Group)
g1<-ggplot(EEG2, aes(x = Hz, y = Fz)) +
geom_line(aes(group=subID), col="grey80") +
#stat_smooth(aes(group=Group, lty=Group), col="black", method="loess", size=1, lwd=1.5)+
facet_wrap(~Group, ncol=2)
g2<-g1+scale_x_continuous(name = "Frequency (Hz)", limits=c(0,20)) +
scale_y_continuous(name = expression("Power " (mu* "V^2")))
g3 <- g2 + theme_bw() +
theme(axis.text=element_text(size=20, colour="black"),
axis.title=element_text(size=20,face="bold"),
plot.title=element_text(size=20,face="bold", hjust = 0.5)) +
theme(strip.text.x = element_text(size = 20))+
theme(legend.position="none")
plot(g3)
g4<- g3 + geom_line(aes(x=Hz, y=mFz, lty=Group),
lwd=1.5, data=EEG3)
plot(g4)
## Frontal Asymmetry -----------------------------------------------------------
## FAS as a function of block number and group ----
# Our primary dependent variable is FAS_alpha_Drest
head(PRAC)
F1 <- lmer(delta_FAS_rest~1+block.c+self.c+(1+block|subID), data=PRAC, REML = FALSE)
summary(F1)
F2 <- lmer(delta_FAS_rest~1+block.c+self.c+diff.c+(1+block|subID), data=PRAC, REML = FALSE)
summary(F2)
F3 <- lmer(delta_FAS_rest~1+block.c+self.c+diff.c+scoreQ.c+(1+block|subID), data=PRAC, REML = FALSE)
summary(F3)
F4 <- lmer(delta_FAS_rest~1+block.c*self.c+diff.c*self.c+
scoreQ.c*self.c+(1+block|subID), data=PRAC, REML = FALSE)
summary(F4)
AICc(F4)
F5 <- lmer(delta_FAS_rest~1+block.c*self.c+diff.c*self.c
+scoreQ.c*self.c+eng_st.c*self.c+(1+block|subID), data=PRAC, REML = FALSE)
summary(F5)
F6 <- lmer(delta_FAS_rest~1+block.c*self.c+diff.c*self.c
+scoreQ.c*self.c+mot_st.c*self.c+(1+block|subID), data=PRAC, REML = FALSE)
summary(F6)
anova(F1,F2,F3,F4,F5,F6)
